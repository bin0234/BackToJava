# Think in Java - Chapter2 一切都是对象

  Java是一种更”纯粹“的面向对象程序设计语言。Java语言假设我们只进行面向对象的程序设计，在Java中几乎一切都是对象。

## 2.1用引用操作对象

  在Java中， 一切都被视为对象，我们通操作引用来操作对象。

```mermaid
graph LR
a[操作标识符]
b[对象]
a--引用-->b
```

  我们也可以仅创建操作标识符，而不指定其引用的对象。

```java
String s;	//仅创建引用s，并不创建与之关联的对象
```



## 2.2 必须由你创建所有对象

### 2.2.1 存储到什么地方

1. 存储器：最快的存储器（位于CPU内部），不能直接控制，也不能在程序中感受到寄存器存在的迹象。
2. 堆栈：位于通用RAM（随机访问存储器）中，通过堆栈指针从处理器哪里获得直接支持，堆栈指针若向下移动，则分配新的内存。若向上移动，则释放内存。创建程序时，Java系统必须知道存储在堆栈内所有项的确切生命周期，以便上下移动指针。这一约束限制了程序的灵活性，所以虽然**某些Java数据存储于堆栈中，特别是对象引用，但是Java对象并不存储于其中。**
3. 堆：一**种通用的内存池（也位于RAM区）用于存放所有Java对象**。堆不同于堆栈的好处是：编译器不需要知道存储的数据在堆里存活多长时间。因此，在堆中分配存储有很大的灵活性，带来的坏处是用堆进行存储分配和清理可能比用堆栈进行分配需要更多时间。
4. 常量存储：常量通常直接存放在代码内部，这样做到好处是它们永远不会被改变。有时，常量本身会和其他部分隔离开，所以在这种情况下，可以选择将其放在ROM（制度存储器）中。
5. 非RAM存储：如果数据完成存货与程序之外，那么它可以不受程序的任何控制，在程序未运行时也可以存在（持久化）。

### 2.2.2 特例：基本类型

| 基本类型 | 大小    | 最小值    | 最大值             | 包装器类型 |
| -------- | ------- | --------- | ------------------ | ---------- |
| boolean  | -       | -         | -                  | Boolean    |
| char     | 16 bit  | Unicode 0 | Unicode ${2^16 -1} | Character  |
| byte     | 8 bits  | -128      | +127               | Byte       |
| short    | 16 bits |           |                    | Short      |
| int      | 32 bits |           |                    | Integer    |
| long     | 64 bits |           |                    | Long       |
| float    | 32 bits | IEEE 754  | IEEE 754           | Float      |
| double   | 64 bits | IEEE 754  | IEEE 754           | Double     |
| void     | -       | -         | -                  | Void       |

  所有数值类型都有正负号，在java中并不存在`unsigned`修饰符  。

  boolean类型所占存储空间的大小没有明确指定，仅定义为能够取字面值**true**或**false**。

  基本变量不用new来创建，而是创建一个并非是引用的”自动“变量。**这个变量直接存储”值“，并置于堆栈中**，因此更加高效。

  基本类型具有包装器类，使得可以在堆中创建一个非基本对象，用来表示对应的基本类型。

```java
char c = 'x';
Character ch = new Character('x');
// JDK5 中提供自动装箱功能可以自动将基本类型转换为包装器类型
Character ch = 'x';
// 并且可以反向转换
char c = ch;
```

* 高精度数字

  `BigInteger`和`BigDecimal`。虽然二者属于包装类型，但二者都没有对应基本类型。

  作用于`int`和`float`的操作，也同样能作用于`BigInteger`和`BigDecimal`。只不过必须**以方法调用方式取代运算符方式**来实现。

  `BigInteger`支持任意精度的整数。`BigDecimal`支持任何精度的定点数。

### 2.2.3 Java中的数组

  Java会确保数组被初始化，而且不能在它的范围之外被访问。**这种范围检查，是以每个数组上少量的内存开销及运行时的下标检查为代价的。但由此换来的是安全性和效率的提高。**

  当创建一个数组对象时，实际上是创建了一个引用数组，并且每个引用都会被初始化为一个特定值，该值拥有自己的关键词`null`。一旦Java看到`null`，就知道这个引用还没有指向某个对象。在使用任何引用前，必须为其指定一个对象；如果试图使用一个还是`null`的引用，在运行时将会报错。【因此，常犯的数组错误在Java中可以得以避免】

![image-20200903210436372](https://i.loli.net/2020/09/03/tF8npVhsDgcNLiJ.png)

